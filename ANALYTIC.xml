WITH TEMP1 AS (
    SELECT '11' AS VALS, 'A' AS TEAM, 11 AS ORDERS FROM DUAL UNION ALL
    SELECT '12' AS VALS, 'A' AS TEAM, 12 AS ORDERS FROM DUAL UNION ALL
    SELECT '13' AS VALS, 'A' AS TEAM, 13 AS ORDERS FROM DUAL UNION ALL
    SELECT '14' AS VALS, 'B' AS TEAM, 14 AS ORDERS FROM DUAL UNION ALL
    SELECT '15' AS VALS, 'B' AS TEAM, 15 AS ORDERS FROM DUAL UNION ALL
    SELECT '16' AS VALS, 'B' AS TEAM, 16 AS ORDERS FROM DUAL
)
SELECT VALS,
       FIRST_VALUE(VALS) OVER(PARTITION BY TEAM ORDER BY ORDERS) AS FV_ORDERS,
       FIRST_VALUE(VALS) OVER(PARTITION BY TEAM ORDER BY ORDERS DESC) AS FV_ORDERS_DESC,
       LAST_VALUE(VALS) OVER(PARTITION BY TEAM ORDER BY ORDERS ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS LV_ORDERS_FIRST,
       LAST_VALUE(VALS) OVER(PARTITION BY TEAM ORDER BY ORDERS ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS LV_ORDERS_SECOND,
       LAST_VALUE(VALS) OVER(PARTITION BY TEAM ORDER BY ORDERS DESC) AS LV_ORDERS_DESC_FIRST,
       LAST_VALUE(VALS) OVER(PARTITION BY TEAM ORDER BY ORDERS DESC ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS LV_ORDERS_DESC_SECIND,
       LEAST(NVL(NULL,VALS), 14) AS LEAST_VALS
  FROM TEMP1;